# لایه‌ی پیوند/لینک

## محتویات درس

‫در قسمت انتهایی مدل TCP/IP لایه‌ی لینک قرار دارد. این لایه، لایه‌ی خاص سخت‌افزاری می‌باشد.

‫در لایه‌ی لینک، بسته‌ی ما یک بار دیگه در چیزی به اسم فریم/frame پیچیده می‌شود. هدرِ فریم آدرس‌های مک مبدا و مقصد میزبان ما، چک‌سام‌ها و جداکننده‌ی بسته را ضمیمه می‌کند تا دریافت‌کننده بتواند پایان یک بسته را اعلام کند.

‫خوشبختانه ما بر روی یک شبکه‌ی مشابه قرار داریم در نتیجه بسته‌ی ما قرار نیست که مسیر طولانی را طی کند. اول لایه‌ی لینک آدرس مک را به هدرِ فریم ضمیمه می‌کند. اما بایستی که آدرس مکِ Patty را هم بداند. چگونه بایستی آدرس مک‌ی که روی شبکه اینترنت نیست را پیدا کنیم؟ از ARP استفاده می‌کنیم.

**ARP (پروتکل تفکیک آدرس)**

‫ARP آدرس مک‌ی که با یک آدرس آی‌پی مرتبط است را پیدا می‌کند. ARP برای یک شبکه استفاده می‌شود. اگر Patty بر روی شبکه‌ی ما نباشد، از سیستم مسیریابی برای مشخص کردن روتر بعدی که می‌تواند دریافت‌کننده بسته باشد استفاده می‌کنیم. در اینجا ما بر روی یک شبکه هستیم و می‌توانیم از ARP استفاده کنیم.

‫زمانی که بر روی یک شبکه‌ایم، سیستم ابتدا با استفاده از اطلاعات جدول مراجعه ARP متوجه می‌شود که چه آدرس آی‌پی با چه آدرس سخت‌افزاری یا مک در ارتباط است.  اگه مقدار مورد نظر در آنجا قرار نداشت، در ادامه از پروتکل تفکیک آدرس یا همان ARP استفاده می‌شود. در اینجا سیستم یک "پیغام برادکست" با استفاده از ARP بر روی شبکه مخابره می‌کند تا دریابد کدام میزبان آی‌پی 10.10.1.4 را دارد.  "پیغام برادکست" یک پیغام ویژه است که به همه‌ی میزبان‌های بر روی یک شبکه برادکست یا مخابره می‌شود. هر دستگاهی با یک آدرس آی‌پی درخواست شده، با یک بسته‌ی ARP که شامل آدرس آی‌پی و آدرس مک می‌شود به پیغام پاسخ می‌دهد.

حالا تمام اطلاعات مورد نیاز را در اختیار داریم. آدرس IP و آدرس‌های MAC، لایه‌ی لینک این چارچوب را از طریق کارت رابط شبکه فوروارد می‌کند و به دستگاه بعدی می‌رساند و شبکه‌ی Patty را پیدا می‌کند. این مرحله کمی پیچیده‌تر از چیزی‌ست که ما توضیح دادیم ولی در دوره‌ی مسیریابی (Routing) در خصوص آن اطلاعات جزئی‌تری خواهیم داد.

‫در لایه‌ی TCP/IP پیمایش بسته‌ی ساده‌ای وجود دارد. در نظر داشته باشید که بسته‌ها به یاد داشته باشید که بسته‌ها به صورت یک‌طرفه سفر نمی‌کنند. ما هنوز به شبکه‌ی Patty هم نرسیده‌ایم! از بین شبکه‌ها عبور می‌کنیم، بایستی حداقل دوبار از مدل TCP/IP برای هر داده‌ای که فرستاده یا دریافت می‌شود عبور کنیم. در اصل بسته‌ها در واقعیت چیزی شبیه این خواهد بود:

**پیمایش بسته**

+ ‫Pete یک ایمیل به Patty می‌فرستد: این داده‌ها به لایه‌ی انتقال فرستاده می‌شود.
+ ‫لایه‌ی انتقال، داده‌ها را در یک هدر TCP یا UDP بسته‌بندی تا یک بخش بسازد. بخش، پورت مقصد و منبع TCP یا UDP را ضمیمه کرده و سپس آن بخش به لایه‌ی شبکه فرستاده می‌شود.
+ لایه‌ی شبکه، بخش TCP را در داخل یک بسته IP قرار می‌دهد و آدرس IP منبع و مقصد را به آن ضمیمه می‌کند. سپس آن را به سمت لایه‌ی پیوند راهنمایی می‌کند.
+ سپس بسته به سخت‌افزار فیزیکی Pete رسیده و در یک چارچوب قرار می‌گیرد.
+ آدرس MAC منبع و مقصد به چارچوب اضافه می‌شود.
+ این چارچوب توسط لایه‌ی فیزیکی Patty گرفته شده و هر چارچوب برای صحت اصالت بررسی می‌شود و سپس محتویات آن باز شده و بسته‌ی IP به لایه‌ی شبکه فرستاده می‌شود.
+ لایه‌ی شبکه بسته را برای پیدا کردن IP منبع و مقصدی که به آن ضمیمه شده بود، می‌خواند. سپس IP را برای تطابق با IP مقصد بررسی می‌کند. سپس بسته را باز می‌کند و بخش را به لایه‌ی انتقال می‌فرستد.
+لایه‌ی انتقال بخش را باز کرده و پورت TCP یا UDP را بررسی می‌کند تا ارتباطی با لایه‌ی اپلیکیشن بر اساس شماره‌‌های پورت برقرار کند.
+لایه‌ی اپلیکیشن/برنامه داده‌ها را از لایه‌ی انتقالی که مرتبط با پورت مشخص شده بود دریافت می‌کند و در فرم یک ایمیل به Patty نمایش می‌دهد.

## تمرین

تمرینی برای این درس نداریم.

## سوال آزمون

از چه چیزی برای پیدا کردن آدرس MAC بر روی یک شبکه‌ی همسان استفاده می‌شود؟

## پاسخ آزمون

ARP
